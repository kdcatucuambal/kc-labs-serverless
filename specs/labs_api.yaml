openapi: 3.0.1
info:
  title: 
    Fn::Sub: Labs API Sample - ${AWS::StackName}
  version: 0.0.1
  description: |
    This is a sample api labs using Java

x-amazon-apigateway-request-validators:
  all:
    validateRequestBody: true
    validateRequestParameters: true
  params-only:
    validateRequestBody: false
    validateRequestParameters: true

paths:
  /labs/greetings/hello:
    get:
      security:
        - api_key: []
      summary: Returns a hello message with IP address
      description: Returns a hello message with IP address
      operationId: LabsGreetingsGETHello
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: The hello message
        500:
          description: Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: The hello message
      x-amazon-apigateway-integration:
        httpMethod: POST
        type: aws
        timeoutInMillis: 20000
        uri: 
          Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${LabsGreetingsGETHelloLambda.Arn}/invocations
        passThroughBehavior: when_no_templates
        requestTemplates:
          application/json: |-
            {
              "headers": {
                #foreach($param in $input.params().header.keySet())
                "$param": "$util.escapeJavaScript($input.params().header.get($param))" #if($foreach.hasNext),#end
                #end
              }
            }
        responses:
          default:
            statusCode: 200
            responseTemplates:
              application/json: |-
                #set($data = $util.parseJson($input.json('$.body')))
                $data
               
          500:
            statusCode: 500
            responseTemplates:
              application/json: |-
                #set($data = $util.parseJson($input.json('$.body')))
                $data

  /labs/greetings/name/{value}:
    get:
      security:
        - api_key: []    
      summary: Returns a hello message using RequestStreamHandler
      description: Returns a hello message with name
      operationId: LabsGreetingsGETHello2
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: The hello message
                  code:
                    type: string
                    description: The code

        500:
          description: Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: The hello message
                  code:
                    type: string
                    description: The code

        409:
          description: Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: The hello message
                  code:
                    type: string
                    description: The code
      x-amazon-apigateway-integration:
        httpMethod: POST
        type: aws
        timeoutInMillis: 20000
        uri: 
          Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${LabsGreetingGETNameLambda.Arn}/invocations
        passThroughBehavior: when_no_templates
        requestTemplates:
          application/json: |-
            {
              "headers": {
                #foreach($param in $input.params().header.keySet())
                "$param": "$util.escapeJavaScript($input.params().header.get($param))" #if($foreach.hasNext),#end
                #end
              },
              "pathParameters": {
                #foreach($param in $input.params().path.keySet())
                "$param": "$util.escapeJavaScript($input.params().path.get($param))" #if($foreach.hasNext),#end
                #end
              }
            }
        responses:
          default:
            statusCode: 200
            responseTemplates:
              application/json: |-
                $input.json('$')
               
          500:
            statusCode: 500
            responseTemplates:
              application/json: |-
                $input.json('$')

          409:
            statusCode: 409
            responseTemplates:
              application/json: |-
                $input.json('$.body')
                
  /labs/balances/{id}:
    get:
      security:
        - api_key: []
      summary: Returns a hello message using aws_proxy integration
      description: Returns a hello message with IP address
      operationId: LabsBalancesGETByIdLambda
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: The hello message
      x-amazon-apigateway-integration:
        httpMethod: POST
        type: aws_proxy
        timeoutInMillis: 20000
        uri:
         Fn::Join:
            - ""
            - - Fn::Sub: "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${LabsBalancesGETByIdLambda.Arn}:"
              - "${stageVariables.version_alias}/invocations"
          
  /labs/balances:
    get:
      security:
        - api_key: []
        - authorizer: []
      x-amazon-apigateway-request-validator: all
      summary: Returns all balances
      description: Returns all balances from database
      operationId: LabsBalancesGETAll
      parameters:
        - $ref: '#/components/parameters/x-request-id'
        - $ref: '#/components/parameters/x-ip-address'
        - $ref: '#/components/parameters/Authorization'

        - name: page
          in: query
          description: Page number
          required: false
          schema:
            type: number
            format: int32
            default: 1
        - name: code
          in: query
          description: Code
          required: false
          schema:
            type: string

      responses:
        200:
          description: OK
          headers:
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
            x-jws-signature:
              $ref: '#/components/headers/x-jws-signature'
            Content-Language:
              $ref: '#/components/headers/Content-Language'
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Balance'
                
        400:
          $ref: '#/components/responses/Response400'
        401:
          $ref: '#/components/responses/Response401'
        403:
          $ref: '#/components/responses/Response403'
        404:
          $ref: '#/components/responses/Response404'
        409:
          $ref: '#/components/responses/Response409'
        429:
          $ref: '#/components/responses/Response429'
        500:
          $ref: '#/components/responses/Response500'

      x-amazon-apigateway-integration:
        httpMethod: POST
        type: aws
        timeoutInMillis: 20000
        uri:
         Fn::Join:
            - ""
            - - Fn::Sub: "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${LabsBalancesGETAllLambda.Arn}:"
              - "${stageVariables.version_alias}/invocations"
        passThroughBehavior: when_no_templates
        requestTemplates:
          application/json: |-
            {
              "header": {
                "aws_request_id": "$context.requestId",
                "x_authorization": "$input.params().header.get('Authorization')",
                "x_request_id": "$input.params().header.get('x-request-id')",
                "x_ip_address": "$input.params().header.get('x-ip-address')"
              },
              "body" : $input.json('$'),
              "getbody": {
                "queries":{
                  #foreach($param in $input.params().querystring.keySet())
                  "$param": "$util.escapeJavaScript($input.params().querystring.get($param))"#if($foreach.hasNext),#end
                  #end
                },
                "params": {
                  #foreach($param in $input.params().path.keySet())
                  "$param": "$util.escapeJavaScript($input.params().path.get($param))"#if($foreach.hasNext),#end
                  #end
                }
              },
              "service": {
                "apiId": "$context.apiId",
                "operationId": "LabsBalancesGETAll"
              }
            }
        responses:
          default:
            statusCode: 200
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |-
                #set($res = $input.path('$'))
                $input.json('$.body')
          400:
            statusCode: 400
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "El mensaje de solicitud no se encuentra debidamente formateado."}
          401:
            statusCode: 401
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "No se encuentra autorizado para realizar la operación."}

          403:
            statusCode: 403
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "La solicitud ha sido rechazada."}

          404:
            statusCode: 404
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "El objeto no fue encontrado."}

          409:
            statusCode: 409
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "La operación presentó un error durante la ejecución. :)"}

          429:
            statusCode: 429
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "Se ha excedido el número de solicitudes permitidas."}

          500|.*timed.*:
            statusCode: 500
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 #set($cause = $input.path('$.cause'))
                  $cause.errorMessage         
    post:
      security:
        - api_key: []
        - authorizer: []
      x-amazon-apigateway-request-validator: all
      summary: Create a new balance
      description: Create a new balance
      operationId: LabsBalancesPST
      parameters:
        - $ref: '#/components/parameters/x-request-id'
        - $ref: '#/components/parameters/x-ip-address'
        - $ref: '#/components/parameters/Authorization'

      requestBody:
        description: Balance object that needs to be added to the store
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Balance'

      responses:
        201:
          description: OK
          headers:
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Origin:
              schema:
                type: string
            Access-Control-Allow-Headers:
              schema:
                type: string
            x-jws-signature:
              $ref: '#/components/headers/x-jws-signature'
            Content-Language:
              $ref: '#/components/headers/Content-Language'
          content:
            application/json:
              schema:
                type: string
                  
                
        400:
          $ref: '#/components/responses/Response400'
        401:
          $ref: '#/components/responses/Response401'
        403:
          $ref: '#/components/responses/Response403'
        404:
          $ref: '#/components/responses/Response404'
        409:
          $ref: '#/components/responses/Response409'
        429:
          $ref: '#/components/responses/Response429'
        500:
          $ref: '#/components/responses/Response500'

      x-amazon-apigateway-integration:
        httpMethod: POST
        type: aws
        timeoutInMillis: 20000
        uri:
         Fn::Join:
            - ""
            - - Fn::Sub: "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${LabsBalancesPSTLambda.Arn}:"
              - "${stageVariables.version_alias}/invocations"
        passThroughBehavior: when_no_templates
        requestTemplates:
          application/json: |-
            {
              "header": {
                "aws_request_id": "$context.requestId",
                "x_authorization": "$input.params().header.get('Authorization')",
                "x_request_id": "$input.params().header.get('x-request-id')",
                "x_ip_address": "$input.params().header.get('x-ip-address')"
              },
              "body" : $input.json('$'),
              "getbody": {
                "queries":{
                  #foreach($param in $input.params().querystring.keySet())
                  "$param": "$util.escapeJavaScript($input.params().querystring.get($param))"#if($foreach.hasNext),#end
                  #end
                },
                "params": {
                  #foreach($param in $input.params().path.keySet())
                  "$param": "$util.escapeJavaScript($input.params().path.get($param))"#if($foreach.hasNext),#end
                  #end
                }
              },
              "service": {
                "apiId": "$context.apiId",
                "operationId": "LabsBalancesGETAll"
              }
            }
        responses:
          default:
            statusCode: 201
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |-
                #set($res = $input.path('$'))
                $input.json('$.body')
          400:
            statusCode: 400
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "El mensaje de solicitud no se encuentra debidamente formateado."}
          401:
            statusCode: 401
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "No se encuentra autorizado para realizar la operación."}

          403:
            statusCode: 403
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "La solicitud ha sido rechazada."}

          404:
            statusCode: 404
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "El objeto no fue encontrado."}

          409:
            statusCode: 409
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "La operación presentó un error durante la ejecución. :)"}

          429:
            statusCode: 429
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "Se ha excedido el número de solicitudes permitidas."}

          500|.*timed.*:
            statusCode: 500
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 #set($cause = $input.path('$.cause'))
                  $cause.errorMessage      
    
      summary: Returns all balances OPT
      description: Returns all balances from database OPT
      operationId: LabsBalancesGETAllOPT
      responses:
        200:
          description: Success
          headers:
            Access-Control-Allow-Headers:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Origin:
              schema:
                type: string
          content: {}
      x-amazon-apigateway-integration:
        responses:
          default:
            statusCode: 200
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |
                {}
        requestTemplates:
          application/json: "{\"statusCode\": 200}"
        passthroughBehavior: when_no_match
        type: mock
    options:
      summary: Balances OPT
      description: Balances OPT
      operationId: BalancesOPT
      responses:
        200:
          description: Success
          headers:
            Access-Control-Allow-Headers:
              schema:
                type: string
            Access-Control-Allow-Methods:
              schema:
                type: string
            Access-Control-Allow-Origin:
              schema:
                type: string
          content: {}
      x-amazon-apigateway-integration:
        responses:
          default:
            statusCode: 200
            responseParameters:
              method.response.header.Access-Control-Allow-Headers: '''*'''
              method.response.header.Access-Control-Allow-Methods: '''*'''
              method.response.header.Access-Control-Allow-Origin: '''*'''
            responseTemplates:
              application/json: |
                {}
        requestTemplates:
          application/json: "{\"statusCode\": 200}"
        passthroughBehavior: when_no_match
        type: mock

  /dummy/put:
    put:
      security:
        - api_key: []
      x-amazon-apigateway-request-validator: all
      summary: Returns all dummy data
      description: Returns all Dummy data
      operationId: LabsDummyPUT
      parameters:
        - $ref: '#/components/parameters/x-request-id'
        - $ref: '#/components/parameters/x-ip-address'
        - $ref: '#/components/parameters/Authorization'

      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Test'
        required: true

      responses:
        200:
          description: OK
          headers:
            x-jws-signature:
              $ref: '#/components/headers/x-jws-signature'
            Content-Language:
              $ref: '#/components/headers/Content-Language'
          content:
            application/json:
              schema:
                type: object
                
        400:
          $ref: '#/components/responses/Response400'
        401:
          $ref: '#/components/responses/Response401'
        403:
          $ref: '#/components/responses/Response403'
        404:
          $ref: '#/components/responses/Response404'
        409:
          $ref: '#/components/responses/Response409'
        429:
          $ref: '#/components/responses/Response429'
        500:
          $ref: '#/components/responses/Response500'

      x-amazon-apigateway-integration:
        httpMethod: POST
        type: aws
        timeoutInMillis: 20000
        uri:
         Fn::Join:
            - ""
            - - Fn::Sub: "arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${LabsDummyPUTLambda.Arn}:"
              - "${stageVariables.version_alias}/invocations"
        passThroughBehavior: when_no_templates
        requestTemplates:
          application/json: |-
            {
              "header": {
                "aws_request_id": "$context.requestId",
                "x_authorization": "$input.params().header.get('Authorization')",
                "x_request_id": "$input.params().header.get('x-request-id')",
                "x_ip_address": "$input.params().header.get('x-ip-address')"
              },
              "body" : $input.json('$'),
              "getbody": {
                "queries":{
                  #foreach($param in $input.params().querystring.keySet())
                  "$param": "$util.escapeJavaScript($input.params().querystring.get($param))"#if($foreach.hasNext),#end
                  #end
                },
                "params": {
                  #foreach($param in $input.params().path.keySet())
                  "$param": "$util.escapeJavaScript($input.params().path.get($param))"#if($foreach.hasNext),#end
                  #end
                }
              },
              "service": {
                "apiId": "$context.apiId",
                "operationId": "LabsBalancesGETAll"
              }
            }
        responses:
          default:
            statusCode: 200
            # responseParameters:
            #   method.response.header.Access-Control-Allow-Credentials: "'true'"
            #   method.response.header.Access-Control-Allow-Headers: "'*'"
            responseTemplates:
              application/json: |-
                #set($res = $input.path('$'))
                $input.json('$.body')
          400:
            statusCode: 400
            # responseParameters:
            #   method.response.header.Access-Control-Allow-Credentials: "'true'"
            #   method.response.header.Access-Control-Allow-Headers: "'*'"
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "El mensaje de solicitud no se encuentra debidamente formateado."}
          401:
            statusCode: 401
            # responseParameters:
            #   method.response.header.Access-Control-Allow-Credentials: "'true'"
            #   method.response.header.Access-Control-Allow-Headers: "'*'"
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "No se encuentra autorizado para realizar la operación."}

          403:
            statusCode: 403
            # responseParameters:
            #   method.response.header.Access-Control-Allow-Credentials: "'true'"
            #   method.response.header.Access-Control-Allow-Headers: "'*'"
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "La solicitud ha sido rechazada."}

          404:
            statusCode: 404
            # responseParameters:
            #   method.response.header.Access-Control-Allow-Credentials: "'true'"
            #   method.response.header.Access-Control-Allow-Headers: "'*'"
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "El objeto no fue encontrado."}

          409:
            statusCode: 409
            # responseParameters:
            #   method.response.header.Access-Control-Allow-Credentials: "'true'"
            #   method.response.header.Access-Control-Allow-Headers: "'*'"
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "La operación presentó un error durante la ejecución. :)"}

          429:
            statusCode: 429
            # responseParameters:
            #   method.response.header.Access-Control-Allow-Credentials: "'true'"
            #   method.response.header.Access-Control-Allow-Headers: "'*'"
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 {"message": "Se ha excedido el número de solicitudes permitidas."}

          500|.*timed.*:
            statusCode: 500
            # responseParameters:
            #   method.response.header.Access-Control-Allow-Credentials: "'true'"
            #   method.response.header.Access-Control-Allow-Headers: "'*'"
            responseTemplates:
              application/json: |-
                 #set($res = $input.path('$'))
                 #set($cause = $input.path('$.cause'))
                  $cause.errorMessage       

components:
  schemas:
    Balance:
      type: object
      description: The balance object
      properties:
        code:
          type: string
          description: The code
        username:
          type: string
          description: The username
        average: 
          type: number
          description: The average
        current:
          type: number
          description: The current
        records:
          type: array
          description: The records
          items:
            $ref: '#/components/schemas/Record'
    Record:
      type: object
      description: The record object
      properties:
        date: 
          type: number
          description: The date
          format: int64
        description:
          type: string
          description: The description
        type:
          type: string
          description: The type
    ErrorResponse:
      type: object
      properties:
        message:
          type: string
          description: "The error message"

    Test:
      type: object
      required:
        - values
      properties:
        idCustomer:
          type:
            - string
            - "null"
        values:
          type: object
          additionalProperties: true


    RuleExecutePUTRq:
        description: "Cuerpo de petición para ejecutar la api de reglas acepta nulls"
        type: object
        allOf:
          - $ref: "#/components/schemas/RuleExecuteBody"
          - type: object
        properties:
          idCustomer:
            nullable: true
          idCard:
            oneOf:
              - type: string
              - type: "null"
            nullable: true
          idRol:
            nullable: true
          # ruleRequest:
          #   type: array
          #   items:
          #     allOf:
          #       - $ref: "#/components/schemas/RuleRequest"
          #       - type: object
          #     properties:
          #       version:
          #         nullable: true
          #       acronym:
          #         nullable: true
          #       values:
          #         nullable: true
    
    RuleExecuteBody:
      description: "Cuerpo de petición para ejecutar la api de reglas"
      type: object
      properties:
        idCustomer:
          type: integer
          format: int64
          description: "Identificador del cliente"
          nullable: true
        idCard:
          type: string
          description: "Identificador de la tarjeta"
          nullable: true
        idRol:
          type: integer
          format: int64
          description: "Identificador del rol"
          nullable: true
        # ruleRequest:
        #   type: array
        #   nullable: true
        #   items:
        #     $ref: "#/components/schemas/RuleRequest"

    RuleRequest:
      type: object
      properties:
        version:
          type: integer
          nullable: true
        acronym:
          type: string
          nullable: true
        values:
          type: object
          additionalProperties: true

  headers:
    Content-Language:
      description: "The content language"
      schema:
        type: string
    
    x-jws-signature:
      description: "The JWS signature"
      schema:
        type: string

  parameters:
    x-request-id:
      name: "x-request-id"
      description: "The request ID"
      in: header
      required: true
      schema:
        type: string
    x-ip-address:
      name: "x-ip-address"
      description: "The IP address"
      in: header
      schema:
        type: string
    Authorization:
      name: "Authorization"
      description: "The authorization token"
      in: header
      required: true
      schema:
        type: string

  responses:
    Response400:
      description: "Bad request"
      headers:
        Content-Language:
          $ref: "#/components/headers/Content-Language"
        Access-Control-Allow-Methods:
          schema:
            type: string
        Access-Control-Allow-Origin:
          schema:
            type: string
        Access-Control-Allow-Headers:
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    
    Response401:
      description: "Unauthorized"
      headers:
        Content-Language:
          $ref: "#/components/headers/Content-Language"
        Access-Control-Allow-Methods:
          schema:
            type: string
        Access-Control-Allow-Origin:
          schema:
            type: string
        Access-Control-Allow-Headers:
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    Response403:
      description: "Forbidden"
      headers:
        Content-Language:
          $ref: "#/components/headers/Content-Language"
        Access-Control-Allow-Methods:
          schema:
            type: string
        Access-Control-Allow-Origin:
          schema:
            type: string
        Access-Control-Allow-Headers:
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    Response404:
      description: "Not found"
      headers:
        Content-Language:
          $ref: "#/components/headers/Content-Language"
        Access-Control-Allow-Methods:
          schema:
            type: string
        Access-Control-Allow-Origin:
          schema:
            type: string
        Access-Control-Allow-Headers:
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    Response409:
      description: "Conflict"
      headers:
        Content-Language:
          $ref: "#/components/headers/Content-Language"
        Access-Control-Allow-Methods:
          schema:
            type: string
        Access-Control-Allow-Origin:
          schema:
            type: string
        Access-Control-Allow-Headers:
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    Response429:
      description: "Too many requests"
      headers:
        Content-Language:
          $ref: "#/components/headers/Content-Language"
        Access-Control-Allow-Methods:
          schema:
            type: string
        Access-Control-Allow-Origin:
          schema:
            type: string
        Access-Control-Allow-Headers:
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

    Response500:
      description: "Internal server error"
      headers:
        Content-Language:
          $ref: "#/components/headers/Content-Language"
        Access-Control-Allow-Methods:
          schema:
            type: string
        Access-Control-Allow-Origin:
          schema:
            type: string
        Access-Control-Allow-Headers:
          schema:
            type: string
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

  securitySchemes:
    api_key:
      type: apiKey
      in: header
      name: x-api-key
      description: 'API key or aborts with Unauthorized'
    authorizer:
      type: apiKey
      in: header
      name: Authorization
      description: 'Token JWT para el consumo del API.'
      x-amazon-apigateway-authtype: custom
      x-amazon-apigateway-authorizer:
        type: token
        identitySource: v1
        authorizerUri:
          Fn::Sub: arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:${LambdaAuthorizer}:production/invocations
        authorizerResultTtlInSeconds: 3600
        identityValidationExpression: ^Bearer [-0-9a-zA-z\.]*$